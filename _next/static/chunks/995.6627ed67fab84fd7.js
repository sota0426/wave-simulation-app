"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[995],{8995:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var s=a(7437),r=a(2265),n=a(8478),l=a(7283),i=a(4692),o=a(1448);a(2446);var c=a(144);function u(e){let{start:t,end:a,color:l,phaseShift:i,attenuation:c,frequency:u,speed:x,timeRef:d,isRunning:h}=e,p=(0,r.useRef)(null),m=(0,r.useMemo)(()=>{let e=new Float32Array(303);for(let s=0;s<=100;s++){let r=s/100,n=t.clone().lerp(a,r);e[3*s]=n.x,e[3*s+1]=n.y,e[3*s+2]=n.z}return e},[t,a]),g=(0,r.useMemo)(()=>{let e=new o.BufferGeometry;return e.setAttribute("position",new o.BufferAttribute(m,3)),e},[m]);return(0,n.F)(()=>{if(!h||!p.current)return;let e=g.attributes.position,a=e.array;for(let e=0;e<=100;e++){let s=a[3*e],r=a[3*e+2],n=new o.Vector3(s,0,r),l=t.distanceTo(n),h=2*Math.exp(-l*c/300)*Math.sin(l*u-d.current*x+i);a[3*e+1]=h}e.needsUpdate=!0}),(0,s.jsx)("primitive",{object:new o.Line(g,new o.LineBasicMaterial({color:l})),ref:p})}function x(e){let{sourceDistance:t,period:a,speed:l,dot:i,attenuation:c,blackThreshold:x,phaseShift:d,isRunning:h,isSelectable:p,isExtracted:m,onPointSelected:g,selectedPoint:f}=e,b=(0,r.useRef)(null),j=(0,r.useRef)(0),y=(0,r.useRef)(null),w=(0,r.useRef)(null),M=(0,r.useRef)(null),v=(0,r.useRef)(0),N=(0,r.useMemo)(()=>{let e=new o.PlaneGeometry(70,70,i,i);e.rotateX(-Math.PI/2);let t=new Float32Array(3*e.attributes.position.count);return e.setAttribute("color",new o.BufferAttribute(t,3)),e},[i]);(0,n.F)((e,s)=>{if(!h)return;j.current+=s;let r=1/a,n=new o.Vector3(t/2,0,0),i=new o.Vector3(-t/2,0,0);if(f){let e=new o.Vector3(f[0],f[1],f[2]),t=e.distanceTo(n),a=2*Math.exp(-t*c/300)*Math.sin(t*r-j.current*l),s=e.distanceTo(i),u=a+2*Math.exp(-s*c/300)*Math.sin(s*r-j.current*l+d);y.current&&(y.current.position.y=u),v.current=u}if(j.current+=s,j.current>3*a&&(j.current=0),w.current){let e=2*Math.sin(-j.current*l);w.current.position.y=e}if(M.current){let e=2*Math.sin(-j.current*l+d);M.current.position.y=e}if(!(m&&f)){if(!b.current)return;let e=b.current.geometry.attributes.position.array,a=b.current.geometry.attributes.color.array,s=e.length/3,n=[t/2,0,0],i=[-t/2,0,0];for(let t=0;t<s;t++){let s=e[3*t],o=3*t+1,u=e[3*t+2],h=Math.sqrt(Math.pow(s-n[0],2)+Math.pow(u-n[2],2)),p=Math.sqrt(Math.pow(s-i[0],2)+Math.pow(u-i[2],2)),m=2*Math.exp(-h*c/300)*Math.sin(h*r-j.current*l);if(m+=2*Math.exp(-p*c/300)*Math.sin(p*r-j.current*l+d),e[o]=m,Math.abs(m)<x)a[3*t]=0,a[3*t+1]=0,a[3*t+2]=0;else{let e=(m+2)/4;a[3*t]=e,a[3*t+1]=.5,a[3*t+2]=1-e}}b.current.geometry.attributes.position.needsUpdate=!0,b.current.geometry.attributes.color.needsUpdate=!0,b.current.geometry.computeVertexNormals(),y.current&&f&&(y.current.position.y=e[1])}});let F=e=>{if(!p)return;e.stopPropagation();let t=e.point;g([t.x,t.y,t.z])},k=new o.Vector3(t/2,0,0),S=new o.Vector3(-t/2,0,0);return(0,s.jsxs)(s.Fragment,{children:[!m&&(0,s.jsxs)("mesh",{ref:b,onPointerDown:F,children:[(0,s.jsx)("primitive",{object:N}),(0,s.jsx)("meshPhongMaterial",{vertexColors:!0,wireframe:!0,side:o.DoubleSide})]}),f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u,{start:k,end:new o.Vector3(f[0],f[1],f[2]),color:"red",phaseShift:0,attenuation:c,frequency:1/a,speed:l,timeRef:j,isRunning:h}),(0,s.jsx)(u,{start:S,end:new o.Vector3(f[0],f[1],f[2]),color:"blue",phaseShift:d,attenuation:c,frequency:1/a,speed:l,timeRef:j,isRunning:h})]}),f&&(0,s.jsxs)("mesh",{ref:y,position:new o.Vector3(f[0],f[1],f[2]),onPointerDown:F,children:[(0,s.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,s.jsx)("meshBasicMaterial",{color:"yellow"})]}),(0,s.jsxs)("mesh",{ref:w,position:k,children:[(0,s.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,s.jsx)("meshBasicMaterial",{color:"red"})]}),(0,s.jsxs)("mesh",{ref:M,position:S,children:[(0,s.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,s.jsx)("meshBasicMaterial",{color:"blue"})]})]})}function d(){let[e,t]=(0,r.useState)(20),[a,n]=(0,r.useState)(1),[o,u]=(0,r.useState)(2),[d,h]=(0,r.useState)(200),[p,m]=(0,r.useState)(20),[g,f]=(0,r.useState)(0),[b,j]=(0,r.useState)(0),[y,w]=(0,r.useState)(!0),[M,v]=(0,r.useState)(!0),[N,F]=(0,r.useState)(!1),[k,S]=(0,r.useState)(null),[C,P]=(0,r.useState)(null),I=o*a;return(0,s.jsxs)("div",{className:"p-4 max-w-full mx-auto",children:[(0,s.jsxs)("div",{className:"flex flex-wrap space-x-4 ",children:[(0,s.jsxs)("label",{className:"block text-black",children:["波源の距離: ",e.toFixed(1)," (λ = ",I.toFixed(2),")",(0,s.jsx)("input",{type:"range",min:"0",max:"30",step:"0.1",value:e,onChange:e=>t(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,s.jsxs)("label",{className:"block text-black",children:["周期: ",a.toFixed(2),(0,s.jsx)("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:a,onChange:e=>n(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,s.jsxs)("label",{className:"block text-black",children:["速さ: ",o.toFixed(2),(0,s.jsx)("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:o,onChange:e=>u(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap space-x-4",children:[(0,s.jsxs)("label",{className:"block text-black",children:["減衰度: ",p.toFixed(0),(0,s.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:p,onChange:e=>m(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,s.jsxs)("label",{className:"block text-black",children:["ドット数: ",d.toFixed(0),(0,s.jsx)("input",{type:"range",min:"50",max:"300",step:"10",value:d,onChange:e=>h(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,s.jsxs)("label",{className:"block text-black",children:["この変位以下を黒色表示: ",g.toFixed(2),(0,s.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:g,onChange:e=>f(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap space-x-4 mb-4",children:[(0,s.jsxs)("label",{className:"block text-black",children:["青色の位相の遅れ: ",(180*b/Math.PI).toFixed(0),"\xb0 （",(0,s.jsx)(c.InlineMath,{math:`${(b/Math.PI).toFixed(1)}\\pi`}),"）",(0,s.jsx)("input",{type:"range",min:"0",max:"360",step:"30",value:(180*b/Math.PI).toFixed(0),onChange:e=>{j(parseFloat(e.target.value)*Math.PI/180)},className:"w-full bg-gray-700 rounded"})]}),(0,s.jsx)("button",{onClick:()=>{w(!y)},className:"px-4 py-2 text-white bg-blue-500 rounded",children:y?"Stop":"Start"}),(0,s.jsxs)("label",{className:"flex items-center text-black",children:[(0,s.jsx)("input",{type:"checkbox",checked:M,onChange:e=>{v(e.target.checked),e.target.checked||(S(null),P(null),F(!1))},className:"mr-2"}),"点を選択する"]}),(0,s.jsx)("button",{onClick:()=>F(!N),className:"px-4 py-2 text-white bg-green-500 rounded",disabled:!k,children:N?"元に戻す":"波を抽出"})]}),(0,s.jsxs)("div",{className:"w-full h-screen bg-gray-900 relative",children:[(0,s.jsxs)(l.Xz,{className:"mx-auto w-full h-3/4",camera:{position:[0,30,30],fov:60},children:[(0,s.jsx)(i.z,{}),(0,s.jsx)("ambientLight",{intensity:.5}),(0,s.jsx)("pointLight",{position:[10,10,10],intensity:1}),(0,s.jsx)(x,{sourceDistance:e,period:a,speed:o,dot:d,attenuation:p,blackThreshold:g,phaseShift:b,isRunning:y,isSelectable:M,isExtracted:N,onPointSelected:t=>{S(t);let a=[e/2,0,0],s=[-e/2,0,0],r=Math.sqrt(Math.pow(t[0]-a[0],2)+Math.pow(t[2]-a[2],2)),n=Math.sqrt(Math.pow(t[0]-s[0],2)+Math.pow(t[2]-s[2],2)),l=Math.abs(r-n),i=l/I,o=Math.floor(i),c=i-o;P({distance1:r,distance2:n,distance1InWavelengths:r/I,distance2InWavelengths:n/I,difference:l,differenceInWavelengths:i,integerPart:o,fractionalPart:c})},selectedPoint:k})]}),C&&k&&(0,s.jsxs)("div",{style:{position:"absolute",top:"10px",left:"10px",color:"white",background:"rgba(0,0,0,0.5)",padding:"10px",pointerEvents:"none"},children:[(0,s.jsxs)("p",{children:["波源(赤)からの距離: ",C.distance1.toFixed(2)," (",C.distance1InWavelengths.toFixed(2),"λ)"]}),(0,s.jsxs)("p",{children:["波源(青)からの距離: ",C.distance2.toFixed(2)," (",C.distance2InWavelengths.toFixed(2),"λ)"]}),(0,s.jsxs)("p",{children:["距離の差: ",C.difference.toFixed(2)," (",C.differenceInWavelengths.toFixed(2),"λ = ",C.integerPart,"λ +"," ",C.fractionalPart.toFixed(2),"λ)"]})]})]})]})}function h(e){let{period:t,refractiveIndex1:a,refractiveIndex2:l,dot:i,blackThreshold:c,isRunning:u,refractionBoundary:x}=e,d=(0,r.useRef)(null),h=(0,r.useRef)(0),p=(0,r.useRef)(null),m=(0,r.useMemo)(()=>{let e=new o.PlaneGeometry(70,70,i,i);e.rotateX(-Math.PI/2);let t=new Float32Array(3*e.attributes.position.count);return e.setAttribute("color",new o.BufferAttribute(t,3)),e},[i]),g=(0,r.useMemo)(()=>new o.Vector3(-20,0,0),[]),f=1/a,b=1/l;return(0,n.F)((e,a)=>{if(!u)return;h.current+=a;let s=2*Math.PI/t,r=s/f,n=s/b;if(!d.current)return;let l=d.current.geometry.attributes.position.array,i=d.current.geometry.attributes.color.array,o=l.length/3;for(let e=0;e<o;e++){let t=l[3*e],a=l[3*e+2],o=3*e+1,u=0;if(t<=x&&(u+=2*Math.sin(r*Math.sqrt(Math.pow(t-g.x,2)+Math.pow(a-g.z,2))-s*h.current)),t>x){let e=Math.asin(b/f*Math.sin(Math.atan2(a-g.z,x-g.x))),r=x+(t-x)*Math.cos(e),l=a+(t-x)*Math.sin(e);u+=2*Math.sin(n*Math.sqrt(Math.pow(r-x,2)+Math.pow(l-g.z,2))-s*h.current)}if(l[o]=u,Math.abs(u)<c)i[3*e]=0,i[3*e+1]=0,i[3*e+2]=0;else{let t=(u+2)/4;i[3*e]=t,i[3*e+1]=.5,i[3*e+2]=1-t}}d.current.geometry.attributes.position.needsUpdate=!0,d.current.geometry.attributes.color.needsUpdate=!0,d.current.geometry.computeVertexNormals()}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("mesh",{ref:d,children:[(0,s.jsx)("primitive",{object:m}),(0,s.jsx)("meshPhongMaterial",{vertexColors:!0,wireframe:!0,side:o.DoubleSide})]}),(0,s.jsxs)("mesh",{ref:p,position:g,children:[(0,s.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,s.jsx)("meshBasicMaterial",{color:"red"})]}),(0,s.jsxs)("mesh",{position:[x,0,0],rotation:[0,Math.PI/2,0],children:[(0,s.jsx)("planeGeometry",{args:[70,70]}),(0,s.jsx)("meshBasicMaterial",{color:"gray",side:o.DoubleSide})]})]})}function p(){let[e,t]=(0,r.useState)(1),[a,n]=(0,r.useState)(1),[o,c]=(0,r.useState)(1.5),[u,x]=(0,r.useState)(200),[d,p]=(0,r.useState)(0),[m,g]=(0,r.useState)(!0),[f,b]=(0,r.useState)(0);return(0,s.jsxs)("div",{className:"p-4 max-w-full mx-auto",children:[(0,s.jsxs)("div",{className:"flex flex-wrap space-x-4",children:[(0,s.jsxs)("label",{className:"block text-black",children:["周期: ",e.toFixed(2),(0,s.jsx)("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:e,onChange:e=>t(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,s.jsxs)("label",{className:"block text-black",children:["媒質1の屈折率: ",a.toFixed(2),(0,s.jsx)("input",{type:"range",min:"1",max:"2",step:"0.1",value:a,onChange:e=>n(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,s.jsxs)("label",{className:"block text-black",children:["媒質2の屈折率: ",o.toFixed(2),(0,s.jsx)("input",{type:"range",min:"1",max:"2",step:"0.1",value:o,onChange:e=>c(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap space-x-4",children:[(0,s.jsxs)("label",{className:"block text-black",children:["ドット数: ",u.toFixed(0),(0,s.jsx)("input",{type:"range",min:"100",max:"400",step:"10",value:u,onChange:e=>x(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]}),(0,s.jsxs)("label",{className:"block text-black",children:["この変位以下を黒色表示: ",d.toFixed(2),(0,s.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:d,onChange:e=>p(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]})]}),(0,s.jsx)("div",{className:"flex flex-wrap space-x-4 mb-4",children:(0,s.jsxs)("label",{className:"block text-black",children:["屈折境界面の位置: ",f.toFixed(1),(0,s.jsx)("input",{type:"range",min:"-30",max:"30",step:"0.1",value:f,onChange:e=>b(parseFloat(e.target.value)),className:"w-full bg-gray-700 rounded"})]})}),(0,s.jsx)("div",{className:"flex flex-wrap space-x-4 mb-4",children:(0,s.jsx)("button",{onClick:()=>{g(!m)},className:"px-4 py-2 text-white bg-blue-500 rounded",children:m?"Stop":"Start"})}),(0,s.jsx)("div",{className:"w-full h-screen bg-gray-900 relative",children:(0,s.jsxs)(l.Xz,{className:"mx-auto w-full h-3/4",camera:{position:[-50,50,100],fov:60},children:[(0,s.jsx)(i.z,{}),(0,s.jsx)("ambientLight",{intensity:.5}),(0,s.jsx)("pointLight",{position:[10,10,10],intensity:1}),(0,s.jsx)(h,{period:e,refractiveIndex1:a,refractiveIndex2:o,dot:u,blackThreshold:d,isRunning:m,refractionBoundary:f})]})})]})}function m(){let[e,t]=(0,r.useState)("wave");return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"p-4 max-w-full mx-auto",children:"wave"===e?(0,s.jsx)(d,{}):(0,s.jsx)(p,{})})})}}}]);